{"version":3,"file":"replays-battle.js","names":["showAd","id","window","top","__vm_add","success","document","readyState","addEventListener","placement","createElement","setAttribute","innerWidth","querySelector","appendChild","push","BattleDiv","_preact$Component","_inheritsLoose","apply","arguments","_proto","prototype","shouldComponentUpdate","render","preact","h","style","position","Component","BattleLogDiv","_preact$Component2","_proto2","BattlePanel","_preact$Component3","_this","_len","length","args","Array","_key","call","concat","result","undefined","battle","speed","keyCode","turnView","autofocusTurnView","keyPressed","e","_e$target","_e$target2","_this$battle","_this$battle2","closeTurn","target","tagName","atQueueEnd","replay","paused","play","pause","shiftKey","firstTurn","prevTurn","lastTurn","nextTurn","stepSpeed","alert","String","fromCharCode","preventDefault","forceUpdate","toggleMute","_this$battle3","_this$battle4","_this$battle5","reset","_this$battle6","_this$battle7","seekBy","_this$battle8","_this$battle9","seekTurn","_this$battle10","Infinity","goToTurn","_this$base","_this$battle11","turn","base","value","trim","turnNum","Number","isNaN","switchViewpoint","_this$battle12","_this$battle13","viewpointSwitched","PSRouter","replace","stripQuery","props","clickDownload","_this$result","filename","tier","timestamp","uploadtime","date","Date","getFullYear","getMonth","getDate","toID","p1","name","p2","a","currentTarget","href","BattleLog","createReplayFileHref","download","stopPropagation","changeSpeed","fadeTable","hyperfast","fast","normal","slow","reallyslow","delayTable","messageShownTime","messageFadeTime","scene","updateAcceleration","changeSound","_this$battle14","muted","setMute","openTurn","_this$battle15","_proto3","componentDidMount","loadBattle","onkeydown","componentWillReceiveProps","nextProps","includes","slice","indexOf","_this2","destroy","Net","get","then","JSON","parse","$base","$","Battle","$frame","find","$logFrame","log","split","isReplay","autoresize","subscribe","_","query","decodeQuery","t","parseInt","componentWillUnmount","_this$battle16","componentDidUpdate","_this$base2","select","_this$base3","turnbox","setSelectionRange","focus","delta","_this$base4","values","newValue","_this$battle17","BattleSound","renderNotFound","showingLeft","maxWidth","textAlign","src","alt","imageRendering","renderControls","_this$battle18","_this$battle19","_this$battle20","_this$battle21","_this$result2","_this$result3","atEnd","atStart","started","onSubmit","autofocus","inputMode","size","type","onClick","width","onChange","format","toDateString","rating","stickyRight","bottom"],"sources":["../src/replays-battle.tsx"],"sourcesContent":["/** @jsx preact.h */\r\nimport preact from 'preact';\r\nimport $ from 'jquery';\r\nimport {Net} from './utils';\r\nimport {PSRouter} from './replays';\r\nimport {Battle} from '../../../src/battle';\r\nimport {BattleLog} from '../../../src/battle-log';\r\nimport {BattleSound} from '../../../src/battle-sound';\r\ndeclare function toID(input: string): string;\r\n\r\nfunction showAd(id: string) {\r\n  // @ts-expect-error\r\n  window.top.__vm_add = window.top.__vm_add || [];\r\n\r\n  //this is a x-browser way to make sure content has loaded.\r\n\r\n  (function (success) {\r\n    if (window.document.readyState !== \"loading\") {\r\n      success();\r\n    } else {\r\n      window.document.addEventListener(\"DOMContentLoaded\", function () {\r\n        success();\r\n      });\r\n    }\r\n  })(function () {\r\n    var placement = document.createElement(\"div\");\r\n    placement.setAttribute(\"class\", \"vm-placement\");\r\n    if (window.innerWidth > 1000) {\r\n      //load desktop placement\r\n      placement.setAttribute(\"data-id\", \"6452680c0b35755a3f09b59b\");\r\n    } else {\r\n      //load mobile placement\r\n      placement.setAttribute(\"data-id\", \"645268557bc7b571c2f06f62\");\r\n    }\r\n    document.querySelector(\"#\" + id)!.appendChild(placement);\r\n    // @ts-expect-error\r\n    window.top.__vm_add.push(placement);\r\n  });\r\n}\r\n\r\nexport class BattleDiv extends preact.Component {\r\n\toverride shouldComponentUpdate() {\r\n\t\treturn false;\r\n\t}\r\n\toverride render() {\r\n\t\treturn <div class=\"battle\" style={{position: 'relative'}}></div>;\r\n\t}\r\n}\r\nclass BattleLogDiv extends preact.Component {\r\n\toverride shouldComponentUpdate() {\r\n\t\treturn false;\r\n\t}\r\n\toverride render() {\r\n\t\treturn <div class=\"battle-log\"></div>;\r\n\t}\r\n}\r\n\r\nexport class BattlePanel extends preact.Component<{id: string}> {\r\n  result: {\r\n    uploadtime: number;\r\n    id: string;\r\n    format: string;\r\n    p1: string;\r\n    p2: string;\r\n    log: string;\r\n    views: number;\r\n    p1id: string;\r\n    p2id: string;\r\n    rating: number;\r\n    private: number;\r\n    password: string;\r\n  } | null | undefined = undefined;\r\n  battle: Battle | null;\r\n  speed = 'normal';\r\n  keyCode = '0';\r\n  turnView: boolean | string = false;\r\n  autofocusTurnView: 'select' | 'end' | null = null;\r\n  override componentDidMount() {\r\n    this.loadBattle(this.props.id);\r\n    showAd('LeaderboardBTF');\r\n    window.onkeydown = this.keyPressed;\r\n  }\r\n  override componentWillReceiveProps(nextProps) {\r\n    if (this.stripQuery(this.props.id) !== this.stripQuery(nextProps.id)) {\r\n      this.loadBattle(nextProps.id);\r\n    }\r\n  }\r\n  stripQuery(id: string) {\r\n    return id.includes('?') ? id.slice(0, id.indexOf('?')) : id;\r\n  }\r\n  loadBattle(id: string) {\r\n    if (this.battle) this.battle.destroy();\r\n    this.battle = null;\r\n    this.result = undefined;\r\n\r\n    Net(`https://replay.pokemonshowdown.com/${this.stripQuery(id)}.json`).get().then(result => {\r\n      const replay: NonNullable<BattlePanel['result']> = JSON.parse(result);\r\n      this.result = replay;\r\n      const $base = $(this.base!);\r\n      this.battle = new Battle({\r\n        id: replay.id,\r\n        $frame: $base.find('.battle'),\r\n        $logFrame: $base.find('.battle-log'),\r\n        log: replay.log.split('\\n'),\r\n        isReplay: true,\r\n        paused: true,\r\n        autoresize: true,\r\n      });\r\n      // for ease of debugging\r\n      (window as any).battle = this.battle;\r\n      this.battle.subscribe(_ => {\r\n        this.forceUpdate();\r\n      });\r\n      const query = Net.decodeQuery(id);\r\n      if ('p2' in query) {\r\n        this.battle.switchViewpoint();\r\n      }\r\n      if (query.turn || query.t) {\r\n        this.battle.seekTurn(parseInt(query.turn || query.t, 10));\r\n      }\r\n      this.forceUpdate();\r\n    }).catch(_ => {\r\n      this.result = null;\r\n      this.forceUpdate();\r\n    });\r\n  }\r\n  override componentWillUnmount(): void {\r\n    this.battle?.destroy();\r\n    (window as any).battle = null;\r\n    window.onkeydown = null;\r\n  }\r\n  override componentDidUpdate(): void {\r\n    if (this.autofocusTurnView === 'select') {\r\n      this.base?.querySelector<HTMLInputElement>('input[name=turn]')?.select();\r\n      this.autofocusTurnView = null;\r\n    }\r\n    if (this.autofocusTurnView === 'end') {\r\n      const turnbox = this.base?.querySelector<HTMLInputElement>('input[name=turn]');\r\n      turnbox?.setSelectionRange(2, 2);\r\n      turnbox?.focus();\r\n      this.autofocusTurnView = null;\r\n    }\r\n  }\r\n  keyPressed = (e: KeyboardEvent) => {\r\n    // @ts-ignore\r\n    this.keyCode = `${e.keyCode}`;\r\n    if (e.keyCode === 27 && this.turnView) { // Esc\r\n      this.closeTurn();\r\n      return;\r\n    }\r\n    // @ts-ignore\r\n    if (e.target?.tagName === 'INPUT' || e.target?.tagName === 'SELECT') return;\r\n    switch (e.keyCode) {\r\n    case 75: // k\r\n      if (this.battle?.atQueueEnd) {\r\n        this.replay();\r\n      } else if (this.battle?.paused) {\r\n        this.play();\r\n      } else {\r\n        this.pause();\r\n      }\r\n      break;\r\n    case 74: // j\r\n      if (e.shiftKey) this.firstTurn();\r\n      else this.prevTurn();\r\n      break;\r\n    case 76: // l\r\n      if (e.shiftKey) this.lastTurn();\r\n      else this.nextTurn();\r\n      break;\r\n    case 188: // , (<)\r\n      if (e.shiftKey) this.stepSpeed(-1);\r\n      break;\r\n    case 190: // . (>)\r\n      if (e.shiftKey) this.stepSpeed(1);\r\n      break;\r\n    case 191: // / (?)\r\n      if (e.shiftKey) {\r\n        alert(\r\n          'k = play/pause\\n' +\r\n          'j = previous turn\\n' +\r\n          'l = next turn\\n' +\r\n          'J = first turn\\n' +\r\n          'L = last turn\\n' +\r\n          'm = mute\\n' +\r\n          '< = slower\\n' +\r\n          '> = faster\\n' +\r\n          '1-9 = skip to turn\\n' +\r\n          '? = keyboard shortcuts (this)\\n'\r\n        );\r\n      }\r\n      break;\r\n    case 48: case 49: case 50: case 51: case 52: case 53: case 54: case 55: case 56: case 57:\r\n    case 96: case 97: case 98: case 99: case 100: case 101: case 102: case 103: case 104: case 105:\r\n      this.turnView = String.fromCharCode(e.keyCode - (e.keyCode >= 96 ? 48 : 0));\r\n      if (this.turnView === '0') this.turnView = '10';\r\n      this.autofocusTurnView = 'end';\r\n      e.preventDefault();\r\n      this.forceUpdate();\r\n      break;\r\n    case 77: // m\r\n      this.toggleMute();\r\n      break;\r\n    }\r\n    this.forceUpdate();\r\n  };\r\n  play = () => {\r\n    this.battle?.play();\r\n  };\r\n  replay = () => {\r\n    this.battle?.reset();\r\n    this.battle?.play();\r\n    this.forceUpdate();\r\n  };\r\n  pause = () => {\r\n    this.battle?.pause();\r\n  };\r\n  nextTurn = () => {\r\n    this.battle?.seekBy(1);\r\n  };\r\n  prevTurn = () => {\r\n    this.battle?.seekBy(-1);\r\n  };\r\n  firstTurn = () => {\r\n    this.battle?.seekTurn(0);\r\n  };\r\n  lastTurn = () => {\r\n    this.battle?.seekTurn(Infinity);\r\n  };\r\n  goToTurn = (e) => {\r\n\t\tconst turn = this.base?.querySelector<HTMLInputElement>('input[name=turn]')?.value;\r\n\t\tif (!turn?.trim()) return this.closeTurn(e);\r\n\t\tlet turnNum = Number(turn);\r\n\t\tif (turn === 'e' || turn === 'end' || turn === 'f' || turn === 'finish') turnNum = Infinity;\r\n\t\tif (isNaN(turnNum) || turnNum < 0) alert(\"Invalid turn\");\r\n\t\tthis.battle?.seekTurn(turnNum);\r\n    this.closeTurn(e);\r\n  };\r\n  switchViewpoint = () => {\r\n    this.battle?.switchViewpoint();\r\n    if (this.battle?.viewpointSwitched) {\r\n      PSRouter.replace(this.stripQuery(this.props.id) + '?p2');\r\n    } else {\r\n      PSRouter.replace(this.stripQuery(this.props.id));\r\n    }\r\n  };\r\n\tclickDownload = (e: MouseEvent) => {\r\n    if (!this.battle) {\r\n      // should never happen\r\n      alert(\"Wait for the battle to finish loading before downloading.\");\r\n      return;\r\n    }\r\n\t\tlet filename = (this.battle.tier || 'Battle').replace(/[^A-Za-z0-9]/g, '');\r\n\r\n\t\t// ladies and gentlemen, JavaScript dates\r\n\t\tconst timestamp = (this.result?.uploadtime || 0) * 1000;\r\n\t\tconst date = new Date(timestamp);\r\n\t\tfilename += '-' + date.getFullYear();\r\n\t\tfilename += (date.getMonth() >= 9 ? '-' : '-0') + (date.getMonth() + 1);\r\n\t\tfilename += (date.getDate() >= 10 ? '-' : '-0') + date.getDate();\r\n\r\n\t\tfilename += '-' + toID(this.battle.p1.name);\r\n\t\tfilename += '-' + toID(this.battle.p2.name);\r\n\r\n    const a = e.currentTarget as HTMLAnchorElement;\r\n\t\ta.href = BattleLog.createReplayFileHref({battle: this.battle});\r\n\t\ta.download = filename + '.html';\r\n\r\n\t\te.stopPropagation();\r\n\t};\r\n  changeSpeed = (e: Event | {target: HTMLSelectElement}) => {\r\n    this.speed = (e.target as HTMLSelectElement).value;\r\n    const fadeTable = {\r\n      hyperfast: 40,\r\n      fast: 50,\r\n      normal: 300,\r\n      slow: 500,\r\n      reallyslow: 1000\r\n    };\r\n    const delayTable = {\r\n      hyperfast: 1,\r\n      fast: 1,\r\n      normal: 1,\r\n      slow: 1000,\r\n      reallyslow: 3000\r\n    };\r\n    if (!this.battle) return;\r\n    this.battle.messageShownTime = delayTable[this.speed];\r\n    this.battle.messageFadeTime = fadeTable[this.speed];\r\n    this.battle.scene.updateAcceleration();\r\n  };\r\n  stepSpeed(delta: number) {\r\n    const target = this.base?.querySelector<HTMLSelectElement>('select[name=speed]');\r\n    if (!target) return; // should never happen\r\n    const values = ['reallyslow', 'slow', 'normal', 'fast', 'hyperfast'];\r\n    const newValue = values[values.indexOf(target.value) + delta];\r\n    if (newValue) {\r\n      target.value = newValue;\r\n      this.changeSpeed({target});\r\n    }\r\n  }\r\n  toggleMute() {\r\n    this.battle?.setMute(!BattleSound.muted);\r\n    this.forceUpdate();\r\n  }\r\n  changeSound = (e: Event) => {\r\n    const muted = (e.target as HTMLSelectElement).value;\r\n    this.battle?.setMute(muted === 'off');\r\n  };\r\n  openTurn = (e: Event) => {\r\n    this.turnView = `${this.battle?.turn}` || true;\r\n    this.autofocusTurnView = 'select';\r\n    e.preventDefault();\r\n    this.forceUpdate();\r\n  };\r\n  closeTurn = (e?: Event) => {\r\n    this.turnView = false;\r\n    e?.preventDefault();\r\n    this.forceUpdate();\r\n  };\r\n  renderNotFound() {\r\n    return <div class={PSRouter.showingLeft() ? 'mainbar has-sidebar' : 'mainbar'}><section class=\"section\" style={{maxWidth: '200px'}}>\r\n      {/* <div style={{margin: '0 -20px'}}>\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-n.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-o.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-t.png\" alt=\"\" width={120} height={120} />\r\n      </div>\r\n      <div style={{margin: '-40px -20px 0'}}>\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-f.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-o.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-u.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-n.png\" alt=\"\" width={120} height={120} style={{marginRight: '-60px'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/dex/unown-d.png\" alt=\"\" width={120} height={120} />\r\n      </div> */}\r\n      <div style={{textAlign: 'center'}}>\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-n.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-o.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-t.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n      </div>\r\n      <div style={{textAlign: 'center'}}>\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-f.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-o.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-u.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-n.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n        <img src=\"//play.pokemonshowdown.com/sprites/gen5ani/unown-d.gif\" alt=\"\" style={{imageRendering: 'pixelated'}} />\r\n      </div>\r\n    </section><section class=\"section\">\r\n\t\t\t<h1>Not Found</h1>\r\n\t\t\t<p>\r\n\t\t\t\tThe battle you're looking for has expired. Battles expire after 15 minutes of inactivity unless they're saved.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tIn the future, remember to click <strong>Upload and share replay</strong> to save a replay permanently.\r\n\t\t\t</p>\r\n    </section></div>;\r\n  }\r\n  renderControls() {\r\n    const atEnd = this.battle?.atQueueEnd;\r\n    const atStart = !this.battle?.started;\r\n\r\n    if (this.turnView) {\r\n      const value = this.turnView === true ? undefined : this.turnView;\r\n      this.turnView = true;\r\n      return <div class=\"replay-controls\"><section class=\"section\">\r\n        <form onSubmit={this.goToTurn}>\r\n          Turn? <input name=\"turn\" autofocus value={value} inputMode=\"numeric\" class=\"textbox\" size={5} /> {}\r\n          <button type=\"submit\" class=\"button\"><strong>Go</strong></button> {}\r\n          <button type=\"button\" class=\"button\" onClick={this.closeTurn}>Cancel</button>\r\n        </form>\r\n      </section></div>;\r\n    }\r\n\r\n    return <div class=\"replay-controls\">\r\n      <p>\r\n        {atEnd ?\r\n          <button onClick={this.replay} class=\"button\" style={{width: '5em'}}>\r\n            <i class=\"fa fa-undo\"></i><br />Replay\r\n          </button>\r\n        : this.battle?.paused ?\r\n          <button onClick={this.play} class=\"button\" style={{width: '5em'}}>\r\n            <i class=\"fa fa-play\"></i><br />Play\r\n          </button>\r\n        :\r\n          <button onClick={this.pause} class=\"button\" style={{width: '5em'}}>\r\n            <i class=\"fa fa-pause\"></i><br />Pause\r\n          </button>\r\n        } {}\r\n        <button class={\"button button-first\" + (atStart ? \" disabled\" : \"\")} onClick={this.firstTurn}>\r\n          <i class=\"fa fa-fast-backward\"></i><br />First turn\r\n        </button>\r\n        <button class={\"button button-middle\" + (atStart ? \" disabled\" : \"\")} onClick={this.prevTurn}>\r\n          <i class=\"fa fa-step-backward\"></i><br />Prev turn\r\n        </button>\r\n        <button class={\"button button-middle\" + (atEnd ? \" disabled\" : \"\")} onClick={this.nextTurn}>\r\n          <i class=\"fa fa-step-forward\"></i><br />Skip turn\r\n        </button>\r\n        <button class={\"button button-last\" + (atEnd ? \" disabled\" : \"\")} onClick={this.lastTurn}>\r\n          <i class=\"fa fa-fast-forward\"></i><br />Skip to end\r\n        </button> {}\r\n        <button class=\"button\" onClick={this.openTurn}>\r\n          <i class=\"fa fa-repeat\"></i> Skip to turn...\r\n        </button>\r\n      </p>\r\n      <p>\r\n        <label class=\"optgroup\">\r\n          Speed:<br />\r\n          <select name=\"speed\" class=\"button\" onChange={this.changeSpeed} value={this.speed}>\r\n            <option value=\"hyperfast\">Hyperfast</option>\r\n            <option value=\"fast\">Fast</option>\r\n            <option value=\"normal\">Normal</option>\r\n            <option value=\"slow\">Slow</option>\r\n            <option value=\"reallyslow\">Really slow</option>\r\n          </select>\r\n        </label> {}\r\n        <label class=\"optgroup\">\r\n          Sound:<br />\r\n          <select name=\"speed\" class=\"button\" onChange={this.changeSound} value={BattleSound.muted ? 'off' : 'on'}>\r\n            <option value=\"on\">On</option>\r\n            <option value=\"off\">Muted</option>\r\n          </select>\r\n        </label> {}\r\n        <label class=\"optgroup\">\r\n          Viewpoint:<br />\r\n          <button onClick={this.switchViewpoint} class={this.battle ? 'button' : 'button disabled'}>\r\n            {(this.battle?.viewpointSwitched ? this.result?.p2 : this.result?.p1)} {}\r\n            <i class=\"fa fa-random\" aria-label=\"Switch viewpoint\"></i>\r\n          </button>\r\n        </label>\r\n      </p>\r\n      {this.result ? <h1>\r\n        <strong>{this.result.format}</strong>: {this.result.p1} vs. {this.result.p2}\r\n      </h1> : <h1>\r\n        <em>Loading...</em>\r\n      </h1>}\r\n      {this.result ? <p>\r\n        <a class=\"button\" href=\"#\" onClick={this.clickDownload} style={{float: 'right'}}>\r\n          <i class=\"fa fa-download\" aria-hidden></i> Download\r\n        </a>\r\n        {this.result.uploadtime ? new Date(this.result.uploadtime * 1000).toDateString() : \"Unknown upload date\"}\r\n        {this.result.rating ? [` | `, <em>Rating:</em>, ` ${this.result.rating}`] : ''}\r\n        {/* {} <code>{this.keyCode}</code> */}\r\n      </p> : <p>&nbsp;</p>}\r\n      {!PSRouter.showingLeft() && <p>\r\n        <a href=\".\" class=\"button\"><i class=\"fa fa-caret-left\"></i> More replays</a>\r\n      </p>}\r\n    </div>;\r\n  }\r\n  override render() {\r\n    if (this.result === null) return this.renderNotFound();\r\n\r\n    let position: any = {};\r\n    if (PSRouter.showingLeft()) {\r\n      if (PSRouter.stickyRight) {\r\n        position = {position: 'sticky', top: '0'};\r\n      } else {\r\n        position = {position: 'sticky', bottom: '0'};\r\n      }\r\n    }\r\n\r\n    return <div class={PSRouter.showingLeft() ? 'mainbar has-sidebar' : 'mainbar'} style={position}><div style={{position: 'relative'}}>\r\n      <BattleDiv />\r\n      <BattleLogDiv />\r\n      {this.renderControls()}\r\n      <div id=\"LeaderboardBTF\"></div>\r\n    </div></div>;\r\n  }\r\n}\r\n"],"mappings":"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"}